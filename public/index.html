<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Asylumgram</title>
<script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>

<style>
body {
  margin:0;
  background:#0f0f0f;
  color:white;
  font-family:Arial;
  display:flex;
  flex-direction:column;
  height:100vh;
}

header {
  background:#1a1a1a;
  padding:15px;
  font-size:20px;
  color:#4cafef;
  text-align:center;
}

#messages {
  flex:1;
  padding:15px;
  overflow-y:auto;
  display:flex;
  flex-direction:column;
}

.message {
  margin-bottom:10px;
  padding:8px 12px;
  border-radius:10px;
  max-width:70%;
}

.me {
  background:#4cafef;
  align-self:flex-end;
}

.other {
  background:#333;
  align-self:flex-start;
}

.system {
  align-self:center;
  background:#222;
  font-size:12px;
  opacity:0.7;
}

#inputArea {
  display:flex;
  padding:10px;
  background:#1a1a1a;
}

#msgInput {
  flex:1;
  padding:8px;
  border:none;
  border-radius:6px;
  outline:none;
}

#sendBtn {
  margin-left:10px;
  padding:8px 15px;
  border:none;
  border-radius:6px;
  background:#4cafef;
  color:white;
  cursor:pointer;
}
</style>
</head>

<body>

<header>Asylumgram</header>

<div id="messages"></div>

<div id="inputArea">
  <input id="msgInput" placeholder="Введите сообщение...">
  <button id="sendBtn">Отправить</button>
</div>

<script>
const socket = io();

let myName = prompt("Введите ваше имя");
if(!myName) myName = "Гость";

socket.emit("join", myName);

const input = document.getElementById("msgInput");
const sendBtn = document.getElementById("sendBtn");

sendBtn.onclick = sendMessage;
input.addEventListener("keydown", e=>{
  if(e.key==="Enter") sendMessage();
});

function sendMessage(){
  const text = input.value.trim();
  if(!text) return;

  socket.emit("chat_message", text);
  input.value="";
}

socket.on("chat_message", data=>{
  const div = document.createElement("div");

  if(data.user === myName){
    div.className="message me";
  } else {
    div.className="message other";
  }

  div.innerText = data.user + ": " + data.message;
  document.getElementById("messages").appendChild(div);
});

socket.on("system_message", text=>{
  const div = document.createElement("div");
  div.className="message system";
  div.innerText = text;
  document.getElementById("messages").appendChild(div);
});
</script>

</body>
</html>