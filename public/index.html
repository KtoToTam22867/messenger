<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Discord Clone</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- ========== LOGIN ========== -->
<div id="login-screen" class="login-screen">
  <div class="login-box">
    <div class="login-logo">💬</div>
    <h1>Добро пожаловать!</h1>
    <p class="login-sub">Войди или зайди как гость</p>

    <div class="tabs">
      <button class="tab active" data-tab="guest">Гость</button>
      <button class="tab" data-tab="login">Вход</button>
      <button class="tab" data-tab="register">Регистрация</button>
    </div>

    <div class="avatar-section">
      <div class="av-circle-big" id="login-av">
        <span id="login-av-letter">?</span>
        <img id="login-av-img" class="hidden" alt="">
      </div>
      <label class="av-btn">📷 Загрузить аватар
        <input type="file" id="login-av-file" accept="image/*" hidden>
      </label>
    </div>

    <form id="login-form">
      <div class="field">
        <label>ИМЯ ПОЛЬЗОВАТЕЛЯ</label>
        <input type="text" id="inp-user" placeholder="Введите имя" required autocomplete="off">
      </div>
      <div class="field hidden" id="field-pass">
        <label>ПАРОЛЬ</label>
        <input type="password" id="inp-pass" placeholder="Введите пароль">
      </div>
      <button type="submit" class="submit-btn" id="submit-btn">Войти как гость</button>
      <p class="error-text" id="error-text"></p>
    </form>
  </div>
</div>

<!-- ========== APP ========== -->
<div id="app" class="app hidden">

  <!-- Servers bar -->
  <div class="servers-col">
    <div class="srv-icon active" title="Главная">💬<div class="pill"></div></div>
    <div class="srv-sep"></div>
    <div id="srv-list"></div>
    <div class="srv-icon add-srv" title="Добавить">+</div>
  </div>

  <!-- Sidebar -->
  <div class="sidebar">
    <div class="side-hdr"><h2 id="srv-name">Сервер</h2><span>⌄</span></div>

    <div class="ch-scroll">
      <div class="ch-cat">
        <span class="cat-arr">▾</span> ТЕКСТОВЫЕ КАНАЛЫ
        <button class="add-ch-btn" data-type="text" title="Создать канал">+</button>
      </div>
      <div id="text-ch"></div>

      <div class="ch-cat">
        <span class="cat-arr">▾</span> ГОЛОСОВЫЕ КАНАЛЫ
        <button class="add-ch-btn" data-type="voice" title="Создать канал">+</button>
      </div>
      <div id="voice-ch"></div>
    </div>

    <!-- Voice connection bar -->
    <div class="vc-bar hidden" id="vc-bar">
      <div>
        <div class="vcb-green">🟢 Голосовой канал</div>
        <div class="vcb-name" id="vcb-name"></div>
      </div>
      <button class="vcb-hang" id="vcb-hang" title="Отключиться">📞</button>
    </div>

    <!-- User panel -->
    <div class="user-panel">
      <div class="up-left">
        <div class="up-av-wrap">
          <div class="up-av" id="my-av"></div>
          <div class="up-dot-wrap"><div class="up-dot online"></div></div>
        </div>
        <div class="up-info">
          <div class="up-name" id="my-name"></div>
          <div class="up-sub">В сети</div>
        </div>
      </div>
      <div class="up-btns">
        <button class="up-btn" id="btn-mic" title="Микрофон">🎤</button>
        <button class="up-btn" id="btn-deaf" title="Звук">🔊</button>
        <button class="up-btn" id="btn-cfg" title="Настройки">⚙️</button>
      </div>
    </div>
  </div>

  <!-- Main -->
  <div class="main-col">
    <div class="top-bar">
      <span class="top-hash">#</span>
      <span class="top-name" id="top-name">общий</span>
      <div class="top-right">
        <button class="top-btn" id="btn-members" title="Участники">👥</button>
        <div class="search-box"><input placeholder="Поиск" id="search-inp"></div>
      </div>
    </div>

    <div class="mid-row">
      <!-- Chat -->
      <div class="chat-col" id="chat-col">
        <div class="msg-scroll" id="msg-scroll">
          <div class="welcome">
            <div class="welcome-icon">#</div>
            <h2>Добро пожаловать в #<span id="w-ch-name">общий</span>!</h2>
            <p>Это начало канала.</p>
          </div>
          <div id="msg-list"></div>
        </div>

        <div class="typing-row hidden" id="typing-row">
          <span class="t-dots"><i></i><i></i><i></i></span>
          <span id="typing-who"></span>
        </div>

        <div class="input-row">
          <label class="plus-btn" title="Прикрепить файл">➕
            <input type="file" id="file-inp" accept="image/*,video/*,.gif" hidden>
          </label>
          <textarea id="msg-inp" placeholder="Написать в #общий" rows="1"></textarea>
          <button class="emoji-btn-trigger" id="emoji-btn">😊</button>
        </div>
      </div>

      <!-- Voice UI -->
      <div class="voice-col hidden" id="voice-col">
        <div class="va-title"><h3>🔊 <span id="va-ch-name"></span></h3></div>
        <div class="va-grid" id="va-grid"></div>
        <div class="va-controls">
          <button class="va-btn" id="va-mic" title="Микрофон">🎤</button>
          <button class="va-btn" id="va-cam" title="Камера">📷</button>
          <button class="va-btn" id="va-scr" title="Экран">🖥️</button>
          <button class="va-btn hang" id="va-hang" title="Отключиться">📞</button>
        </div>
      </div>

      <!-- Members -->
      <div class="members-col" id="members-col">
        <div class="mem-cat">В СЕТИ — <span id="online-cnt">0</span></div>
        <div id="mem-list"></div>
      </div>
    </div>
  </div>
</div>

<!-- Emoji picker -->
<div class="emo-popup hidden" id="emo-popup"><div class="emo-grid" id="emo-grid"></div></div>

<!-- Context menu -->
<div class="ctx hidden" id="ctx">
  <div class="ctx-item" data-a="react">😊 Реакция</div>
  <div class="ctx-item" data-a="copy">📋 Копировать</div>
  <div class="ctx-item own-only" data-a="edit">✏️ Редактировать</div>
  <div class="ctx-item own-only" data-a="delete">🗑️ Удалить</div>
</div>

<!-- Create channel modal -->
<div class="modal hidden" id="modal-ch">
  <div class="modal-bg"></div>
  <div class="modal-box">
    <h2>Создать канал</h2>
    <div class="type-row">
      <label class="type-card sel" data-t="text"><span>#</span><div><b>Текстовый</b><p>Сообщения</p></div></label>
      <label class="type-card" data-t="voice"><span>🔊</span><div><b>Голосовой</b><p>Голос и видео</p></div></label>
    </div>
    <div class="field"><label>НАЗВАНИЕ</label><input id="new-ch-inp" placeholder="новый-канал"></div>
    <div class="modal-btns">
      <button class="m-cancel" id="ch-cancel">Отмена</button>
      <button class="m-ok" id="ch-create">Создать</button>
    </div>
  </div>
</div>

<!-- Settings modal -->
<div class="modal hidden" id="modal-cfg">
  <div class="modal-bg"></div>
  <div class="modal-box">
    <h2>⚙️ Настройки</h2>
    <div class="cfg-av-section">
      <div class="av-circle-big" id="cfg-av">
        <span id="cfg-av-letter"></span>
        <img id="cfg-av-img" class="hidden" alt="">
      </div>
      <label class="av-btn">📷 Сменить аватар
        <input type="file" id="cfg-av-file" accept="image/*" hidden>
      </label>
    </div>
    <div class="modal-btns">
      <button class="m-cancel" id="cfg-cancel">Закрыть</button>
      <button class="m-ok" id="cfg-save">Сохранить</button>
    </div>
  </div>
</div>

<!-- Toasts -->
<div class="toast-container" id="toasts"></div>

<script src="/socket.io/socket.io.js"></script>
<script src="app.js"></script>
</body>
</html>